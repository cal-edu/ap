


<head>
 <script type="text/javascript" src="assets/js/canvasjs/canvasjs.min.js"></script>
 <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
 <link rel="stylesheet" href="assets/css/main.css">
 <style> 
  .bigframe {
  background-image: url("assets/pics/ppt.png");
  background-repeat: no-repeat;
  background-size: 1062px 597px;
  width: 1062px;
  height: 597px;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
  </style>
  </head>

<body>

<div class = 'bigframe'> 
 
 
 </div>
 <div id="chartContainer" style="height: 300px; width: 300px;"></div>
 <script type="text/javascript">
        var chart = new CanvasJS.Chart("chartContainer",
        {        
            axisX:{
                minimum: -2,
                maximum: 5
            },
            axisY:{
                minimum: -2,
                maximum: 5
            },
            title: {
                text: "Try dragging column to reposition dataPoint",
            },
            data: [
            {
                type: "line",
                dataPoints: [
                { x: 0, y: 0 },
                { x: 0, y: 1 },
                { x: 0, y: 2 },
                { x: 0, y: 3 }
                ]
            }                   
            ]
        });

        chart.render();

        var xSnapDistance = chart.axisX[0].convertPixelToValue(chart.get("dataPointWidth")) / 2;
        var ySnapDistance = 3;

        var xValue, yValue;

        var mouseDown = false;
        var selected = null;
        var changeCursor = false;
        
        var timerId = null;

        function getPosition(e) {
            var parentOffset = $("#chartContainer > .canvasjs-chart-container").offset();          	
            var relX = e.pageX - parentOffset.left;
            var relY = e.pageY - parentOffset.top;
            xValue = Math.round(chart.axisX[0].convertPixelToValue(relX));
            yValue = Math.round(chart.axisY[0].convertPixelToValue(relY));
        }
        
        function searchDataPoint() {
            var dps = chart.data[0].dataPoints;
            for(var i = 0; i < dps.length; i++ ) {
                if( (xValue >= dps[i].x - xSnapDistance && xValue <= dps[i].x + xSnapDistance) && 
                (yValue >= dps[i].y - ySnapDistance && yValue <= dps[i].y + ySnapDistance) ) {
                    if(mouseDown) {
                        selected = i;
                        break;
                    }
                    else {
                        changeCursor = true;
                        break; 
                    }
                } else {
                    selected = null;
                    changeCursor = false;
                }
            }

        }

        jQuery("#chartContainer > .canvasjs-chart-container").on({
            mousedown: function(e) {
                mouseDown = true;
                getPosition(e);  
                searchDataPoint();
            },
            mousemove: function(e) {
                getPosition(e);
                if(mouseDown) {
                    clearTimeout(timerId);
                    timerId = setTimeout(function(){
                        if(selected != null) {
                            chart.data[0].dataPoints[selected].y = yValue;
                            chart.render();
                        }   
                    }, 0);
                }
                else {
                    searchDataPoint();
                    if(changeCursor) {
                        chart.data[0].set("cursor", "n-resize");
                    } else {
                        chart.data[0].set("cursor", "default");
                    }
                }
            },
            mouseup: function(e) {
                if(selected != null) {
                    chart.data[0].dataPoints[selected].y = yValue;
                    chart.render();
                    mouseDown = false;
                }
            }
        });
    </script>
 
 
 
 
</body>
